sample:
  description: An example to illustrate the usage of
    crypto APIs
  name: Crypto APIs
common:
  tags: crypto
  harness: console
  min_ram: 16
tests:
  test-mbedtls:
    min_flash: 34
    extra_args: CONF_FILE=prj_mtls_shim.conf
    harness_config:
      type: multi_line
      regex:
        - "\\[general\\] \\[INF\\] .*: Cipher Sample"
        - "\\[general\\] \\[INF\\] main: CBC Mode"
        - "\\[general\\] \\[INF\\] mtls_session_setup: Unsupported mode"
        - "\\[general\\] \\[INF\\] main: CTR Mode"
        - "\\[general\\] \\[INF\\] mtls_session_setup: Unsupported mode"
        - "\\[general\\] \\[INF\\] main: CCM Mode"
        - "\\[general\\] \\[INF\\] ccm_mode: CCM mode ENCRYPT - Match"
        - "\\[general\\] \\[INF\\] ccm_mode: CCM mode DECRYPT - Match"
  test-micro:
    tags: micro
    harness_config:
      type: multi_line
      regex:
        - "\\[general\\] \\[INF\\] .*: Cipher Sample"
        - "\\[general\\] \\[INF\\] main: CBC Mode"
        - "\\[general\\] \\[INF\\] cbc_mode: Output length (encryption): 64"
        - "\\[general\\] \\[INF\\] cbc_mode: CBC mode ENCRYPT - Match"
        - "\\[general\\] \\[INF\\] cbc_mode: Output length (decryption): 80"
        - "\\[general\\] \\[INF\\] cbc_mode: CBC mode DECRYPT - Match"
        - "\\[general\\] \\[INF\\] main: CTR Mode"
        - "\\[general\\] \\[INF\\] ctr_mode: Output length (encryption): 64"
        - "\\[general\\] \\[INF\\] ctr_mode: CTR mode ENCRYPT - Match"
        - "\\[general\\] \\[INF\\] ctr_mode: Output length (decryption): 64"
        - "\\[general\\] \\[INF\\] ctr_mode: CTR mode DECRYPT - Match"
        - "\\[general\\] \\[INF\\] main: CCM Mode"
        - "\\[general\\] \\[INF\\] ccm_mode: CCM mode ENCRYPT - Match"
        - "\\[general\\] \\[INF\\] ccm_mode: Output length (encryption): 31"
        - "\\[general\\] \\[INF\\] ccm_mode: CCM mode DECRYPT - Match"
        - "\\[general\\] \\[INF\\] ccm_mode: Output length (decryption): 31"
